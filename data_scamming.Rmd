```{r}
library(tidyverse)
library(lubridate)
```


First we should read and save the tabels into different variables.
```{r}
calories <- read_csv("~/Desktop/google_case_study/Fitabase Data 4.12.16-5.12.16/dailyCalories_merged.csv")
intensities <- read_csv("~/Desktop/google_case_study/Fitabase Data 4.12.16-5.12.16/dailyIntensities_merged.csv")
steps <- read_csv("~/Desktop/google_case_study/Fitabase Data 4.12.16-5.12.16/dailySteps_merged.csv")
heartrate <- read_csv("~/Desktop/google_case_study/Fitabase Data 4.12.16-5.12.16/heartrate_seconds_merged.csv")
weight <- read_csv("~/Desktop/google_case_study/Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv")
sleep <- read_csv("~/Desktop/google_case_study/Fitabase Data 4.12.16-5.12.16/minuteSleep_merged.csv")

```
Now the data is recorded into different variables lets take look at them.




It looks like out date data is not formatted correctly so lets fix it and change the type to data frame and daily data to monthly data in calories table.
```{r}
calories <- as.data.frame(calories)
calories$ActivityDay <- mdy(calories$ActivityDay)
```
Now we can create a month data and create a sum of calories for this table.
```{r}
calories_total <- calories %>% 
  mutate(month = format(ActivityDay, "%Y-%m")) %>% 
  group_by(Id, month) %>% 
  summarize(total_act = sum(Calories))

```



Now we have the month, id and calorie data we can create a better table to better see the summed results of this table.
```{r}
head(calories_total)
```


The calories total table is done, lets inspect other tables.
```{r}
str(heartrate)
```


It looks like heartrate$Time is not formatted in a correct way, we should fix it. We can format this table so that we can get avarage of hearth rate for each month.
```{r}
heartrate <- as.data.frame(heartrate)
heartrate$Time <- mdy_hms(heartrate$Time)
heartrate_total <- heartrate %>% 
  mutate(month = format(Time, "%Y-%m")) %>% 
  group_by(Id, month) %>% 
  summarize(heartrate_mean = mean(Value))
```


It is done, we can see the table now.
```{r}
head(heartrate_total)
```
We shoulp aply a similar data wrangling to other tabels as well.


Sleeping data:
```{r}
str(sleep)
sleep$date <- mdy_hms(sleep$date)
sleep_total <- sleep %>% 
  mutate(month = format(date, "%Y-%m")) %>% 
  group_by(Id, month) %>% 
  summarise(avarage_sleep = sum(value))
```


Steps table:
```{r}
str(steps)
steps <- as.data.frame(steps)
steps$ActivityDay <- mdy(steps$ActivityDay)

steps_total <- steps %>% 
  mutate(month = format(ActivityDay, "%Y-%m")) %>% 
  group_by(Id, month) %>% 
  summarise(average_steps = mean(StepTotal))
  
```


The intensity and weight tables might be useful later on when we need to conduct some tests for statistical significance. For now we can go over last versions of our tables. Lets merge them into one singe table first.
```{r}
merged_total <- calories_total %>% 
  left_join(heartrate_total, by = c("Id", "month")) %>% 
  left_join(sleep_total, by = c("Id", "month")) %>%
  left_join(steps_total, by = c("Id", "month"))
```


As it is seen there are so many data that are missing so that we cannot come to a conclusion with them, so lets cast them out.
```{r}
omit_merged <- na.omit(merged_total)
colnames(omit_merged)[3] <- "total_cal"
```


Let's see the visuals for this merged data if there are some relationships between the variables.
```{r}
heart_cal <- omit_merged %>% 
  ggplot(mapping = aes(x = total_cal, y = heartrate_mean)) +
  geom_point(mapping = aes(color=Id)) +
  geom_smooth(method = "lm")

heart_cal
```
It is stange but it looks like there is a slightly week and negative relationship between total calories burned and heartrate.

Let's see if there is such relationship between average steps and heartrate
```{r}
step_heart <- omit_merged %>% 
  ggplot(mapping = aes(x= average_steps, y=heartrate_mean)) + 
  geom_point()

step_heart 
```
It looks like we made a huge mistake here, because R thinks that the Id data is a continues data. Lets fix it.

```{r}
omit_merged$Id <- as.character(omit_merged$Id)
```

Now we can create those visuals again and see.
```{r}
omit_merged %>% 
  ggplot(mapping = aes(x=average_steps ,y=heartrate_mean, color=Id)) +
  geom_point()
```

We went through this data but the results are very unsatisfying. There is no relationship simple between anything that we can talk about. I don't know what to do in this stage. I think this is enough for today on this data. Tomorrow I will try an other approach.
